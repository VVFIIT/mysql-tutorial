# 唯一索引 UNIQUE

### 唯一索引的特点
唯一索引的创建约束，是该字段的存储的值必须是**不同**的。  
如果您尝试添加现有值匹配的新值，则会发生错误。  
对于所有引擎，UNIQUE 索引允许可以为NULL的字段包含的多个NULL。  
如果为已存在的字段添加唯一索引 ，必须保证该字段的值都是不同的。    

### 创建表时的索引放置顺序
在创建的表中，首先放置PRIMARY KEY ，然后放置所有唯一索引，然后放置非唯一索引。    
这可以帮助MySQL优化器确定要使用的索引的优先级，还可以更快地检测重复的UNIQUE键。

### 语法
```
UNIQUE INDEX `name_index`(`name`) USING BTREE COMMENT '姓名索引'    
UNIQUE INDEX `title_remark_index`(`title`, `remark`) USING BTREE COMMENT '标题+备注索引'
```

<details>
<summary>\_rowid到底是什么</summary>
<pre><code>
\_rowid并不是一个真实存在的列，其本质是一个非空唯一列的别名。为什么会这么说呢？

因为在某些情况下_rowid是不存在的，其只存在于以下情况：
1. 当表中存在一个数字类型的单列主键时，\_rowid其实就是指的是这个主键列
2. 当表中不存在主键但存在一个数字类型的非空唯一列时，\_rowid其实就是指的是对应非空唯一列。

需要注意以下情况是不存在_rowid的：
1. 主键列或者非空唯一列的类型不是数字类型
2. 主键是联合主键
3. 唯一列不是非空的。
————————————————
版权声明：本文为CSDN博主「2的32次方」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/a158123/article/details/89818537
</code></pre>
</details>    



## 主键 PRIMARY KEY
> 一个表只能有一个 PRIMARY KEY（注：请参考复合主键）。  
主键是一种唯一索引，其中所有键列必须定义为 NOT NULL。（如果未将其显式声明为NOT NULL，则MySQL会隐式的声明它们为NOT NULL)   
主键的名字始终为PRIMARY，不能用作任何其他种类的索引的名称。  
请保持PRIMARY KEY简短，以最大程度地减少二级索引（非主键索引）的存储开销。（每个二级索引条目都包含对应行的主键列的副本）

### 语法
```
primary key(id)  
```

### 主键和唯一索引的区别
- 主键是一种约束，唯一索引是一种索引，两者在本质上是不同的。
- 主键创建后一定包含一个唯一性索引，唯一性索引并不一定就是主键。
- 唯一性索引列允许空值，而主键列不允许为空值。
- 主键列在创建时，已经默认为空值 + 唯一索引了。
- 主键可以被其他表引用为外键，而唯一索引不能。
- 一个表最多只能创建一个主键，但可以创建多个唯一索引。
- 主键更适合那些不容易更改的唯一标识，如自动递增列、身份证号等。



### 复合主键
一张表只能有一个主键，但根据需要，我们可以设置多个字段同时为主键，这就叫做复合主键。
复合主键是为了应对表中找不到一个字段是数据不重复的情况。

例如下表：

class | id | name |
------------ | ------------- | ------------ |
一班 | 1 | 章北海 |
一班 | 2 | 郭思航 |
一班 | 3 | 王剑 |
二班 | 1 | 李也 |
二班 | 2 | 张令 |
二班 | 3 | 王剑 |
二班 | 4 | 王剑 |

班级，学号，姓名都无法使用单个字段来唯一标识。
这时，我们可以将多个字段设置为主键，形成复合主键，这多个字段联合标识唯一性。  

### 语法
```
primary key(class,id,name)  
```
复合主键一般用于在一个字段可能有重复的情况下，用多个字段去保持主键的唯一性。  
